schema: '2.0'
stages:
  download_wjazzd_dataset:
    cmd: curl https://jazzomat.hfm-weimar.de/download/downloads/wjazzd.db -o 
      data/raw/wjazzd.db
    outs:
    - path: data/raw/wjazzd.db
      hash: md5
      md5: 89f02b08ce00e3f46ffd466c8f3e0e5d
      size: 42512384
  make_dataset:
    cmd: uv run python -m src.model.make_dataset data/raw/wjazzd.db 
      data/interim/train.json
    deps:
    - path: data/raw/wjazzd.db
      hash: md5
      md5: 89f02b08ce00e3f46ffd466c8f3e0e5d
      size: 42512384
    - path: src/model/make_dataset.py
      hash: md5
      md5: 818ae65b8ebf8b59b259eddd9128ea80
      size: 7645
    outs:
    - path: data/interim/train.json
      hash: md5
      md5: 19832914ba9f4e183cb51740531c5754
      size: 3560985
  train_model_llama-midi:
    cmd: uv run python -m src.model.train_model --model_name 'dx2102/llama-midi'
      --num_train_epochs 30 data/interim/train.json models/llama-midi-e30.pth/
    deps:
    - path: data/interim/train.json
      hash: md5
      md5: 19832914ba9f4e183cb51740531c5754
      size: 3560985
    - path: src/model/train_model.py
      hash: md5
      md5: 32ccd869d9464d9b0ee1728dda2a6bfb
      size: 9099
    outs:
    - path: models/llama-midi-e30.pth/
      hash: md5
      md5: eb087dcbbac14f68f0ebd22de28ad7b7.dir
      size: 62389352
      nfiles: 7
  train_model_llama_3.2-1b:
    cmd: uv run python -m src.model.train_model --model_name 
      'unsloth/Llama-3.2-1B-bnb-4bit' --num_train_epochs 30 
      data/interim/train.json models/llama-3.2-1b-e30.pth/
    deps:
    - path: data/interim/train.json
      hash: md5
      md5: 19832914ba9f4e183cb51740531c5754
      size: 3560985
    - path: src/model/train_model.py
      hash: md5
      md5: 32ccd869d9464d9b0ee1728dda2a6bfb
      size: 9099
    outs:
    - path: models/llama-3.2-1b-e30.pth/
      hash: md5
      md5: 5de6d0a97f3f29decd332da7a5ed256f.dir
      size: 62385622
      nfiles: 6
  evaluate_model:
    cmd: uv run python -m src.model.evaluate --model_paths 
      models/llama-midi-e30.pth/ models/llama-3.2-1b-e30.pth/ --soundfont_path 
      data/raw/FluidR3_GM.sf2 && date > data/interim/flag_evaluate_model.txt
    deps:
    - path: data/raw/FluidR3_GM.sf2
      hash: md5
      md5: 1cc160a92fadb6a43eb1695563524982
      size: 32322864
    - path: models/llama-3.2-1b-e30.pth/
      hash: md5
      md5: 5de6d0a97f3f29decd332da7a5ed256f.dir
      size: 62385622
      nfiles: 6
    - path: models/llama-midi-e30.pth/
      hash: md5
      md5: eb087dcbbac14f68f0ebd22de28ad7b7.dir
      size: 62389352
      nfiles: 7
    - path: src/model/chord_name_parser.py
      hash: md5
      md5: c0a22f1515f985e7c595dbfbe2221d3b
      size: 7068
    - path: src/model/evaluate.py
      hash: md5
      md5: 715636d601cc8f88df1dacaa01939738
      size: 8391
    - path: src/model/melody_processor.py
      hash: md5
      md5: 59be6753782ec198a7b51b3565505d24
      size: 7869
    - path: src/model/utils.py
      hash: md5
      md5: 839cf709a0ff72543968eacc534ad63b
      size: 3468
    outs:
    - path: data/interim/flag_evaluate_model.txt
      hash: md5
      md5: b6915f23609c3d929fd7c12591838c75
      size: 43
  download_soundfont:
    cmd: wget -q 
      https://github.com/mrbumpy409/GeneralUser-GS/raw/refs/heads/main/GeneralUser-GS.sf2
      -O data/raw/FluidR3_GM.sf2
    outs:
    - path: data/raw/FluidR3_GM.sf2
      hash: md5
      md5: 1cc160a92fadb6a43eb1695563524982
      size: 32322864
  train_model@minimum-llama-midi:
    cmd: uv run python -m src.model.train_model --model_name "dx2102/llama-midi"
      --num_train_epochs 1 data/interim/train.json 
      models/minimum-llama-midi.pth/
    deps:
    - path: data/interim/train.json
      hash: md5
      md5: 19832914ba9f4e183cb51740531c5754
      size: 3560985
    - path: src/model/chord_name_parser.py
      hash: md5
      md5: c0a22f1515f985e7c595dbfbe2221d3b
      size: 7068
    - path: src/model/melody_processor.py
      hash: md5
      md5: 2917ef36696cde4b6468e691938c09e3
      size: 12160
    - path: src/model/train_model.py
      hash: md5
      md5: 32ccd869d9464d9b0ee1728dda2a6bfb
      size: 9099
    - path: src/model/utils.py
      hash: md5
      md5: 7702655b36c1259ab1f1cbecd547dd99
      size: 3468
    outs:
    - path: models/minimum-llama-midi.pth/
      hash: md5
      md5: 340e569837fb9c40ef678ddcde4ef723.dir
      size: 62389352
      nfiles: 7
  train_model@minimum-llama-3.2-1b:
    cmd: uv run python -m src.model.train_model --model_name 
      "unsloth/Llama-3.2-1B-bnb-4bit" --num_train_epochs 1 
      data/interim/train.json models/minimum-llama-3.2-1b.pth/
    deps:
    - path: data/interim/train.json
      hash: md5
      md5: 19832914ba9f4e183cb51740531c5754
      size: 3560985
    - path: src/model/chord_name_parser.py
      hash: md5
      md5: c0a22f1515f985e7c595dbfbe2221d3b
      size: 7068
    - path: src/model/melody_processor.py
      hash: md5
      md5: 2917ef36696cde4b6468e691938c09e3
      size: 12160
    - path: src/model/train_model.py
      hash: md5
      md5: 32ccd869d9464d9b0ee1728dda2a6bfb
      size: 9099
    - path: src/model/utils.py
      hash: md5
      md5: 7702655b36c1259ab1f1cbecd547dd99
      size: 3468
    outs:
    - path: models/minimum-llama-3.2-1b.pth/
      hash: md5
      md5: af6a25149623260e77a39370b9e86de8.dir
      size: 62385622
      nfiles: 6
  evaluate_model@minimum-llama-midi:
    cmd: uv run python -m src.model.evaluate --model_paths 
      models/minimum-llama-midi.pth/ --soundfont_path data/raw/FluidR3_GM.sf2 &&
      date > data/interim/flag_evaluate_model-minimum-llama-midi.txt
    deps:
    - path: data/raw/FluidR3_GM.sf2
      hash: md5
      md5: 1cc160a92fadb6a43eb1695563524982
      size: 32322864
    - path: models/minimum-llama-midi.pth/
      hash: md5
      md5: 340e569837fb9c40ef678ddcde4ef723.dir
      size: 62389352
      nfiles: 7
    - path: src/model/chord_name_parser.py
      hash: md5
      md5: c0a22f1515f985e7c595dbfbe2221d3b
      size: 7068
    - path: src/model/evaluate.py
      hash: md5
      md5: b289ba0193371efe4b98951b882cb6f3
      size: 7751
    - path: src/model/melody_processor.py
      hash: md5
      md5: 2917ef36696cde4b6468e691938c09e3
      size: 12160
    - path: src/model/utils.py
      hash: md5
      md5: 7702655b36c1259ab1f1cbecd547dd99
      size: 3468
    - path: src/model/visualize.py
      hash: md5
      md5: b0eeb0f6bda4e21e0ad19cbcb08875f1
      size: 1923
    outs:
    - path: data/interim/flag_evaluate_model-minimum-llama-midi.txt
      hash: md5
      md5: 0456e4a5208957d2300c728ce748a723
      size: 43
  evaluate_model@minimum-llama-3.2-1b:
    cmd: uv run python -m src.model.evaluate --model_paths 
      models/minimum-llama-3.2-1b.pth/ --soundfont_path data/raw/FluidR3_GM.sf2 
      && date > data/interim/flag_evaluate_model-minimum-llama-3.2-1b.txt
    deps:
    - path: data/raw/FluidR3_GM.sf2
      hash: md5
      md5: 1cc160a92fadb6a43eb1695563524982
      size: 32322864
    - path: models/minimum-llama-3.2-1b.pth/
      hash: md5
      md5: af6a25149623260e77a39370b9e86de8.dir
      size: 62385622
      nfiles: 6
    - path: src/model/chord_name_parser.py
      hash: md5
      md5: c0a22f1515f985e7c595dbfbe2221d3b
      size: 7068
    - path: src/model/evaluate.py
      hash: md5
      md5: b289ba0193371efe4b98951b882cb6f3
      size: 7751
    - path: src/model/melody_processor.py
      hash: md5
      md5: 2917ef36696cde4b6468e691938c09e3
      size: 12160
    - path: src/model/utils.py
      hash: md5
      md5: 7702655b36c1259ab1f1cbecd547dd99
      size: 3468
    - path: src/model/visualize.py
      hash: md5
      md5: b0eeb0f6bda4e21e0ad19cbcb08875f1
      size: 1923
    outs:
    - path: data/interim/flag_evaluate_model-minimum-llama-3.2-1b.txt
      hash: md5
      md5: b7f2cf63876c07c209121e385aa29755
      size: 43
  train_model@base-llama-midi:
    cmd: uv run python -m src.model.train_model --model_name "dx2102/llama-midi"
      --num_train_epochs 50 data/interim/train.json models/base-llama-midi.pth/
    deps:
    - path: data/interim/train.json
      hash: md5
      md5: 19832914ba9f4e183cb51740531c5754
      size: 3560985
    - path: src/model/chord_name_parser.py
      hash: md5
      md5: c0a22f1515f985e7c595dbfbe2221d3b
      size: 7068
    - path: src/model/melody_processor.py
      hash: md5
      md5: 2917ef36696cde4b6468e691938c09e3
      size: 12160
    - path: src/model/train_model.py
      hash: md5
      md5: 32ccd869d9464d9b0ee1728dda2a6bfb
      size: 9099
    - path: src/model/utils.py
      hash: md5
      md5: 7702655b36c1259ab1f1cbecd547dd99
      size: 3468
    outs:
    - path: models/base-llama-midi.pth/
      hash: md5
      md5: eb0dd0fa7720128c82b5fecb442f8718.dir
      size: 62389352
      nfiles: 7
  evaluate_model@base-llama-midi:
    cmd: uv run python -m src.model.evaluate --model_paths 
      models/base-llama-midi.pth/ --soundfont_path data/raw/FluidR3_GM.sf2 && 
      date > data/interim/flag_evaluate_model-base-llama-midi.txt
    deps:
    - path: data/raw/FluidR3_GM.sf2
      hash: md5
      md5: 1cc160a92fadb6a43eb1695563524982
      size: 32322864
    - path: models/base-llama-midi.pth/
      hash: md5
      md5: eb0dd0fa7720128c82b5fecb442f8718.dir
      size: 62389352
      nfiles: 7
    - path: src/model/chord_name_parser.py
      hash: md5
      md5: c0a22f1515f985e7c595dbfbe2221d3b
      size: 7068
    - path: src/model/evaluate.py
      hash: md5
      md5: b289ba0193371efe4b98951b882cb6f3
      size: 7751
    - path: src/model/melody_processor.py
      hash: md5
      md5: 2917ef36696cde4b6468e691938c09e3
      size: 12160
    - path: src/model/utils.py
      hash: md5
      md5: 7702655b36c1259ab1f1cbecd547dd99
      size: 3468
    - path: src/model/visualize.py
      hash: md5
      md5: b0eeb0f6bda4e21e0ad19cbcb08875f1
      size: 1923
    outs:
    - path: data/interim/flag_evaluate_model-base-llama-midi.txt
      hash: md5
      md5: b804ecd53c9edb14a61e312e3c0e1c8b
      size: 43
  train_model@e5-llama-midi:
    cmd: uv run python -m src.model.train_model --model_name "dx2102/llama-midi"
      --num_train_epochs 5 data/interim/train.json models/e5-llama-midi.pth/
    deps:
    - path: data/interim/train.json
      hash: md5
      md5: 19832914ba9f4e183cb51740531c5754
      size: 3560985
    - path: src/model/chord_name_parser.py
      hash: md5
      md5: c0a22f1515f985e7c595dbfbe2221d3b
      size: 7068
    - path: src/model/melody_processor.py
      hash: md5
      md5: 2917ef36696cde4b6468e691938c09e3
      size: 12160
    - path: src/model/train_model.py
      hash: md5
      md5: 32ccd869d9464d9b0ee1728dda2a6bfb
      size: 9099
    - path: src/model/utils.py
      hash: md5
      md5: 7702655b36c1259ab1f1cbecd547dd99
      size: 3468
    outs:
    - path: models/e5-llama-midi.pth/
      hash: md5
      md5: 8c9c478cacd572e3a57cd8982ed9c6fb.dir
      size: 62389352
      nfiles: 7
  train_model@e10-llama-midi:
    cmd: uv run python -m src.model.train_model --model_name "dx2102/llama-midi"
      --num_train_epochs 10 data/interim/train.json models/e10-llama-midi.pth/
    deps:
    - path: data/interim/train.json
      hash: md5
      md5: 19832914ba9f4e183cb51740531c5754
      size: 3560985
    - path: src/model/chord_name_parser.py
      hash: md5
      md5: c0a22f1515f985e7c595dbfbe2221d3b
      size: 7068
    - path: src/model/melody_processor.py
      hash: md5
      md5: 2917ef36696cde4b6468e691938c09e3
      size: 12160
    - path: src/model/train_model.py
      hash: md5
      md5: 32ccd869d9464d9b0ee1728dda2a6bfb
      size: 9099
    - path: src/model/utils.py
      hash: md5
      md5: 7702655b36c1259ab1f1cbecd547dd99
      size: 3468
    outs:
    - path: models/e10-llama-midi.pth/
      hash: md5
      md5: 37f9e1f34b4f1d98335716ea2266a14c.dir
      size: 62389352
      nfiles: 7
  train_model@e20-llama-midi:
    cmd: uv run python -m src.model.train_model --model_name "dx2102/llama-midi"
      --num_train_epochs 20 data/interim/train.json models/e20-llama-midi.pth/
    deps:
    - path: data/interim/train.json
      hash: md5
      md5: 19832914ba9f4e183cb51740531c5754
      size: 3560985
    - path: src/model/chord_name_parser.py
      hash: md5
      md5: c0a22f1515f985e7c595dbfbe2221d3b
      size: 7068
    - path: src/model/melody_processor.py
      hash: md5
      md5: 2917ef36696cde4b6468e691938c09e3
      size: 12160
    - path: src/model/train_model.py
      hash: md5
      md5: 32ccd869d9464d9b0ee1728dda2a6bfb
      size: 9099
    - path: src/model/utils.py
      hash: md5
      md5: 7702655b36c1259ab1f1cbecd547dd99
      size: 3468
    outs:
    - path: models/e20-llama-midi.pth/
      hash: md5
      md5: 1bff7efeb1f30953177f8e9db67adffa.dir
      size: 62389352
      nfiles: 7
  train_model@e30-llama-midi:
    cmd: uv run python -m src.model.train_model --model_name "dx2102/llama-midi"
      --num_train_epochs 30 data/interim/train.json models/e30-llama-midi.pth/
    deps:
    - path: data/interim/train.json
      hash: md5
      md5: 19832914ba9f4e183cb51740531c5754
      size: 3560985
    - path: src/model/chord_name_parser.py
      hash: md5
      md5: c0a22f1515f985e7c595dbfbe2221d3b
      size: 7068
    - path: src/model/melody_processor.py
      hash: md5
      md5: 2917ef36696cde4b6468e691938c09e3
      size: 12160
    - path: src/model/train_model.py
      hash: md5
      md5: 32ccd869d9464d9b0ee1728dda2a6bfb
      size: 9099
    - path: src/model/utils.py
      hash: md5
      md5: 7702655b36c1259ab1f1cbecd547dd99
      size: 3468
    outs:
    - path: models/e30-llama-midi.pth/
      hash: md5
      md5: e34fce5a06a05768acf06a6b4650c687.dir
      size: 62389352
      nfiles: 7
  evaluate_model@e5-llama-midi:
    cmd: uv run python -m src.model.evaluate --model_paths 
      models/e5-llama-midi.pth/ --soundfont_path data/raw/FluidR3_GM.sf2 && date
      > data/interim/flag_evaluate_model-e5-llama-midi.txt
    deps:
    - path: data/raw/FluidR3_GM.sf2
      hash: md5
      md5: 1cc160a92fadb6a43eb1695563524982
      size: 32322864
    - path: models/e5-llama-midi.pth/
      hash: md5
      md5: 8c9c478cacd572e3a57cd8982ed9c6fb.dir
      size: 62389352
      nfiles: 7
    - path: src/model/chord_name_parser.py
      hash: md5
      md5: c0a22f1515f985e7c595dbfbe2221d3b
      size: 7068
    - path: src/model/evaluate.py
      hash: md5
      md5: b289ba0193371efe4b98951b882cb6f3
      size: 7751
    - path: src/model/melody_processor.py
      hash: md5
      md5: 2917ef36696cde4b6468e691938c09e3
      size: 12160
    - path: src/model/utils.py
      hash: md5
      md5: 7702655b36c1259ab1f1cbecd547dd99
      size: 3468
    - path: src/model/visualize.py
      hash: md5
      md5: b0eeb0f6bda4e21e0ad19cbcb08875f1
      size: 1923
    outs:
    - path: data/interim/flag_evaluate_model-e5-llama-midi.txt
      hash: md5
      md5: 59df4fb1057e83e325b50f859ec0145c
      size: 43
  evaluate_model@e10-llama-midi:
    cmd: uv run python -m src.model.evaluate --model_paths 
      models/e10-llama-midi.pth/ --soundfont_path data/raw/FluidR3_GM.sf2 && 
      date > data/interim/flag_evaluate_model-e10-llama-midi.txt
    deps:
    - path: data/raw/FluidR3_GM.sf2
      hash: md5
      md5: 1cc160a92fadb6a43eb1695563524982
      size: 32322864
    - path: models/e10-llama-midi.pth/
      hash: md5
      md5: 37f9e1f34b4f1d98335716ea2266a14c.dir
      size: 62389352
      nfiles: 7
    - path: src/model/chord_name_parser.py
      hash: md5
      md5: c0a22f1515f985e7c595dbfbe2221d3b
      size: 7068
    - path: src/model/evaluate.py
      hash: md5
      md5: b289ba0193371efe4b98951b882cb6f3
      size: 7751
    - path: src/model/melody_processor.py
      hash: md5
      md5: 2917ef36696cde4b6468e691938c09e3
      size: 12160
    - path: src/model/utils.py
      hash: md5
      md5: 7702655b36c1259ab1f1cbecd547dd99
      size: 3468
    - path: src/model/visualize.py
      hash: md5
      md5: b0eeb0f6bda4e21e0ad19cbcb08875f1
      size: 1923
    outs:
    - path: data/interim/flag_evaluate_model-e10-llama-midi.txt
      hash: md5
      md5: e58119dfc8c91d31dc81e8ecd981d264
      size: 43
  evaluate_model@e20-llama-midi:
    cmd: uv run python -m src.model.evaluate --model_paths 
      models/e20-llama-midi.pth/ --soundfont_path data/raw/FluidR3_GM.sf2 && 
      date > data/interim/flag_evaluate_model-e20-llama-midi.txt
    deps:
    - path: data/raw/FluidR3_GM.sf2
      hash: md5
      md5: 1cc160a92fadb6a43eb1695563524982
      size: 32322864
    - path: models/e20-llama-midi.pth/
      hash: md5
      md5: 1bff7efeb1f30953177f8e9db67adffa.dir
      size: 62389352
      nfiles: 7
    - path: src/model/chord_name_parser.py
      hash: md5
      md5: c0a22f1515f985e7c595dbfbe2221d3b
      size: 7068
    - path: src/model/evaluate.py
      hash: md5
      md5: b289ba0193371efe4b98951b882cb6f3
      size: 7751
    - path: src/model/melody_processor.py
      hash: md5
      md5: 2917ef36696cde4b6468e691938c09e3
      size: 12160
    - path: src/model/utils.py
      hash: md5
      md5: 7702655b36c1259ab1f1cbecd547dd99
      size: 3468
    - path: src/model/visualize.py
      hash: md5
      md5: b0eeb0f6bda4e21e0ad19cbcb08875f1
      size: 1923
    outs:
    - path: data/interim/flag_evaluate_model-e20-llama-midi.txt
      hash: md5
      md5: 802b65af70c7fa24934275610aadd01b
      size: 43
  evaluate_model@e30-llama-midi:
    cmd: uv run python -m src.model.evaluate --model_paths 
      models/e30-llama-midi.pth/ --soundfont_path data/raw/FluidR3_GM.sf2 && 
      date > data/interim/flag_evaluate_model-e30-llama-midi.txt
    deps:
    - path: data/raw/FluidR3_GM.sf2
      hash: md5
      md5: 1cc160a92fadb6a43eb1695563524982
      size: 32322864
    - path: models/e30-llama-midi.pth/
      hash: md5
      md5: e34fce5a06a05768acf06a6b4650c687.dir
      size: 62389352
      nfiles: 7
    - path: src/model/chord_name_parser.py
      hash: md5
      md5: c0a22f1515f985e7c595dbfbe2221d3b
      size: 7068
    - path: src/model/evaluate.py
      hash: md5
      md5: b289ba0193371efe4b98951b882cb6f3
      size: 7751
    - path: src/model/melody_processor.py
      hash: md5
      md5: 2917ef36696cde4b6468e691938c09e3
      size: 12160
    - path: src/model/utils.py
      hash: md5
      md5: 7702655b36c1259ab1f1cbecd547dd99
      size: 3468
    - path: src/model/visualize.py
      hash: md5
      md5: b0eeb0f6bda4e21e0ad19cbcb08875f1
      size: 1923
    outs:
    - path: data/interim/flag_evaluate_model-e30-llama-midi.txt
      hash: md5
      md5: 15f991e9922227d61982eaa5e352ec9e
      size: 43
